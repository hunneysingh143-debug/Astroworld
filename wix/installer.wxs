<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Id="*" Name="Astroworld" Language="1033" Version="1.0.0.0"
           Manufacturer="Astroworld Inc." UpgradeCode="3f2504e0-4f89-11d3-9a0c-0305e82c3301">
    <Package InstallerVersion="500" Compressed="yes" InstallScope="perMachine" />

    <MediaTemplate />

    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder">
        <Directory Id="INSTALLFOLDER" Name="Astroworld" />
      </Directory>
      <Directory Id="ProgramMenuFolder">
        <Directory Id="ProgramsFolder">
          <Directory Id="ApplicationProgramsFolder" Name="Astroworld" />
        </Directory>
      </Directory>
      <Directory Id="DesktopFolder" />
    </Directory>

    <!-- Main Executable -->
    <DirectoryRef Id="INSTALLFOLDER">
      <Component Id="MainExecutable" Guid="9a5b6c7d-1234-4e5f-8abc-1d2e3f4a5b6c">
        <File Id="AstroExe" Source="$(var.AstroworldDir)\Astroworld.exe" KeyPath="yes" />
      </Component>
    </DirectoryRef>

    <!-- Start Menu Shortcut -->
    <DirectoryRef Id="ApplicationProgramsFolder">
      <Component Id="ProgramMenuShortcut" Guid="a1b2c3d4-e5f6-7890-abcd-1234567890ff">
        <Shortcut Id="AstroStartMenuShortcut" Name="Astroworld"
                  Target="[INSTALLFOLDER]Astroworld.exe" WorkingDirectory="INSTALLFOLDER" />
        <RemoveFolder Id="RemoveProgramsFolder" On="uninstall" />
        <RegistryValue Root="HKCU" Key="Software\Astroworld" Name="installed" Type="integer" Value="1" KeyPath="yes"/>
      </Component>
    </DirectoryRef>

    <!-- Desktop Shortcut -->
    <DirectoryRef Id="DesktopFolder">
      <Component Id="DesktopShortcut" Guid="b2c3d4e5-f678-9012-abcd-1234567890aa">
        <Shortcut Id="AstroDesktopShortcut" Name="Astroworld"
                  Target="[INSTALLFOLDER]Astroworld.exe" WorkingDirectory="INSTALLFOLDER" />
        <RemoveFolder Id="RemoveDesktopFolder" On="uninstall" />
        <RegistryValue Root="HKCU" Key="Software\Astroworld" Name="desktop" Type="integer" Value="1" KeyPath="yes"/>
      </Component>
    </DirectoryRef>

    <Feature Id="ProductFeature" Title="Astroworld" Level="1">
      <ComponentRef Id="MainExecutable" />
      <ComponentRef Id="ProgramMenuShortcut" />
      <ComponentRef Id="DesktopShortcut" />
    </Feature>
  </Product>
</Wix>
